<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Host_Mode - Quick-DEV Programming Guide</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Host_Mode";
        var mkdocs_page_input_path = "examples\\host_mode_example.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Quick-DEV Programming Guide
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Quick-DEV FWK</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../get_started/get_started.html">Get Started</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Application Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../application-guide/project_config.html">Project Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../application-guide/log_config.html">Log Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../application-guide/wifi.html">WI-Fi</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../application-guide/ble.html">BluetoothLE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../application-guide/wifi_provision_via_ble.html">WI-FI Provision Via BLE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../application-guide/cloud.html">Cloud</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../application-guide/ota.html">OTA</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="ble_example.html">BLE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="cloud_example.html">Cloud</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="qd_app_example.html">Start Up</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="wifi_example.html">WI-FI</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="host_mode_example.html">Host_Mode</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#architecture">Architecture</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#binary-build">Binary Build</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#scenarios">Scenarios</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#blewifi-provision">BLE/WiFi Provision</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#tcp">TCP</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../api-reference/wifi_apis.html">WI-FI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api-reference/ble_apis.html">BluetoothLE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api-reference/cloud_apis.html">Cloud</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api-reference/ota_apis.html">OTA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api-reference/opl_error_code.html">OPL Error Code</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Quick-DEV Programming Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Examples &raquo;</li>
      <li>Host_Mode</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/Opulinks-Tech/QuickDev-Framework/edit/master/docs/examples/host_mode_example.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="host-mode-example">Host mode example</h1>
<p>In this host_mode example, the Opulinks device plays as a slave device controlled by another host MCU. The host MCU will send AT command through UART to request Opulinks device to perform WiFi provision, cloud connection, cloud data sending and receiving.
The example application located at “examples\host_mode\at_master”(to simulate host MCU) and “examples\host_mode\at_slave” (Opulinks slave device).</p>
<h2 id="architecture">Architecture</h2>
<p>WThe Host MCU send request to Opulinks device via UART interface, also a wakeup PIN.</p>
<p><img alt="host_mode_architecture" src="img/host_mode.png" /></p>
<h2 id="binary-build">Binary Build</h2>
<p>To setup this demonstration, user must build master and slave binaries separately. There are two kind of cloud server to test, TCP and MQTT. Following screen shot illustrates how to select project with correct server type to build slave binary in MDK-ARM IDE tool. Also do the same to build the correct mater binary.</p>
<p><img alt="host_mode_binary_build" src="img/host_mode_binary_build_1.png" /></p>
<p>To modify the server IP, find the TCP/MQTT IP setting in “APP_HostModeDemoProgress” of “examples\host_mode\at_master\app_main.c”</p>
<pre><code class="language-c">#if defined(HOST_MODE_TCP)
            strcpy((char *)tHostModeReqCmdFmt.u8aPayload, &quot;1,192.168.0.10,21&quot;);
#elif defined(HOST_MODE_MQTT)
            strcpy((char *)tHostModeReqCmdFmt.u8aPayload, &quot;1,broker.emqx.io,8883&quot;);
#endif
</code></pre>
<h2 id="scenarios">Scenarios</h2>
<h3 id="blewifi-provision">BLE/WiFi Provision</h3>
<p>For the first time the host_mode environment has been setup, Master device will send at+provisionstart to Slave device after receiving “Ready”. After revceiving provision request in Slave device (see console), user can do WiFi setup on phone App. (Please refer to Start_up example for detail steps)</p>
<p><img alt="host_mode_ble_wifi_provision_process" src="img/host_mode_ble_wifi_provision_1.png" />
<img alt="host_mode_ble_wifi_provision_console" src="img/host_mode_ble_wifi_provision_console.png" />
<img alt="host_mode_ble_wifi_provision_console_1" src="img/host_mode_ble_wifi_provision_console_1.png" />
<img alt="host_mode_ble_wifi_provision_console_2" src="img/host_mode_ble_wifi_provision_console_2.png" /></p>
<ul>
<li><strong>Cloud connection and enter sleep</strong></li>
</ul>
<p>After Wi-Fi connected, Master device will send <code>at+cloudconn</code> to connect cloud. Once connected, Master device will send at+entsleep to ask Slave device to enter power save mode</p>
<h3 id="tcp">TCP</h3>
<p><img alt="host_mode_tcp" src="img/host_mode_tcp.png" />
<img alt="host_mode_tcp_console" src="img/host_mode_tcp_console.png" />
<img alt="host_mode_tcp_console_1" src="img/host_mode_tcp_console_1.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="wifi_example.html" class="btn btn-neutral float-left" title="WI-FI"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../api-reference/wifi_apis.html" class="btn btn-neutral float-right" title="WI-FI">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright 2022, Opulinks cooperation</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/Opulinks-Tech/QuickDev-Framework" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="wifi_example.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../api-reference/wifi_apis.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
